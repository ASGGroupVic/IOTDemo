<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?AIzaSyB6NWRDjXI4Y7gxxPBnpz9Ms_xX9T04lNU">
    </script>
    <script src="http://cdn.pubnub.com/pubnub-3.7.1.min.js"></script>


    <script>
// Mouseover/ Click sound effect- by JavaScript Kit (www.javascriptkit.com)

      var html5_audiotypes={ 
      //define list of audio file extensions and their associated audio types. Add to it if your specified audio file isn't on this list:
      "mp3": "audio/mpeg"
      }
      function createsoundbite(sound){
        var html5audio=document.createElement('audio')
        if (html5audio.canPlayType){ //check support for HTML5 audio
          for (var i=0; i<arguments.length; i++){
          var sourceel=document.createElement('source')
          sourceel.setAttribute('src', arguments[i])
          if (arguments[i].match(/\.(\w+)$/i))
            sourceel.setAttribute('type', html5_audiotypes[RegExp.$1])
            html5audio.appendChild(sourceel)
          }
          html5audio.load()
          html5audio.playclip=function(){
          html5audio.pause()
          html5audio.currentTime=0
          html5audio.play()
          }
        return html5audio
        }
        else{
          return {playclip:function(){throw new Error("Your browser doesn't support HTML5 audio unfortunately")}}
        }
      }

    var mySound=createsoundbite("pop.mp3")

    </script>



    <script>
      var map;
      function initialize() {
        var mapOptions = {
          zoom: 8,
          center: new google.maps.LatLng(-34.397, 150.644),
          styles: [
    {
        "featureType": "water",
        "stylers": [
            {
                "color": "#021019"
            }
        ]
    },
    {
        "featureType": "landscape",
        "stylers": [
            {
                "color": "#08304b"
            }
        ]
    },
    {
        "featureType": "poi",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#0c4152"
            },
            {
                "lightness": 5
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#000000"
            }
        ]
    },
    {
        "featureType": "road.highway",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "color": "#0b434f"
            },
            {
                "lightness": 25
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#000000"
            }
        ]
    },
    {
        "featureType": "road.arterial",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "color": "#0b3d51"
            },
            {
                "lightness": 16
            }
        ]
    },
    {
        "featureType": "road.local",
        "elementType": "geometry",
        "stylers": [
            {
                "color": "#000000"
            }
        ]
    },
    {
        "elementType": "labels.text.fill",
        "stylers": [
            {
                "color": "#ffffff"
            }
        ]
    },
    {
        "elementType": "labels.text.stroke",
        "stylers": [
            {
                "color": "#000000"
            },
            {
                "lightness": 13
            }
        ]
    },
    {
        "featureType": "transit",
        "stylers": [
            {
                "color": "#146474"
            }
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "geometry.fill",
        "stylers": [
            {
                "color": "#000000"
            }
        ]
    },
    {
        "featureType": "administrative",
        "elementType": "geometry.stroke",
        "stylers": [
            {
                "color": "#144b53"
            },
            {
                "lightness": 14
            },
            {
                "weight": 1.4
            }
        ]
    }
]
        };
        map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>

    <script>
    var pubnub = PUBNUB.init({
      publish_key   : "pub-c-9339f7dd-e9a8-41d7-b3a4-037d25972fc2",
      subscribe_key : "sub-c-34f9f230-6ef5-11e4-bcf0-02ee2ddab7fe"
    });


    var icons = {
      iPhone: {
      icon: 'rsz_apple.png'
      },
      iPad: {
      icon: 'rsz_apple.png'
      },
    Android: {
      icon: 'rsz_android.png'
      },
      Linux: {
      icon: 'rsz_android.png'
      },
    Windows: {
      icon: 'rsz_windows.png'
      },
      Win32: {
      icon: 'rsz_windows.png'
      },
      MacIntel: {
      icon: 'rsz_question.png'
      }
    };

 

var image = {
    url: 'images/beachflag.png',
    // This marker is 20 pixels wide by 32 pixels tall.
    size: new google.maps.Size(20, 32),
    // The origin for this image is 0,0.
    origin: new google.maps.Point(0,0),
    // The anchor for this image is the base of the flagpole at 0,32.
    anchor: new google.maps.Point(0, 32)
  };



    // subscribe to the channel, and render all messages as markers on the map
    pubnub.subscribe({
      channel: 'leontest1',
      message: function(m){
        // get the lat and lon from the message body m.lat and m.lon
        var LatLng = new google.maps.LatLng(m.lat, m.lon);
        //var myIcon = icons[m.device].icon;
        //if (myIcon) {} else {myIcon = icons['MacIntel'].icon;}   
        var myMarker = new google.maps.Marker({
          //icon: myIcon,
          icon: {
            path: google.maps.SymbolPath.CIRCLE,
            scale: 40,
            fillColor: m.colour,
            fillOpacity: 0.4,
            strokeWeight: 0.4,
          },
          position: LatLng,
          animation: "BOUNCE",
          onclick: mySound.playclip(),
          map: map});
       console.log(m)
      }
    });


    

    </script>



  
  </head>
  
  <body>
    <div id="map-canvas"></div>
  </body>
</html>